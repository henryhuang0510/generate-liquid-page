<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            width: 100%;
            height: 100%;

        }

        .slr-main {
            width: 100%;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1rem;
            padding: 1.5rem;
        }

        .slr-main-left {
            width: 100%;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            gap: 1rem;
        }

        .slr-main-left img {
            width: 100%;
            border-radius: 5px;
            box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;
        }

        .slr-main-left .slr-main-left-product-img {
            flex: 1.5;
        }

        .slr-main-left .slr-main-left-product-img img {
            height: 100%;
        }

        .slr-main-left .slr-main-left-preview-imgs {
            flex: 1;
            height: 100vh;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            overflow-y: auto;
            scrollbar-width: none;
            cursor: pointer;
        }

        .slr-main-left .slr-main-left-preview-imgs::-webkit-scrollbar {
            display: none;
        }

        .slr-thumbnail-btn {
            width: 100%;
            height: 12rem;
            overflow: hidden;
            border: 2px solid transparent;
            background: #fff;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .slr-thumbnail-btn.locked {
            border-color: #222222 !important;
        }

        .slr-thumbnail-btn:hover {
            border-color: #222222;
        }

        .slr-thumbnail-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* 悬停预览样式 */
        .slr-thumbnail-container:hover .slr-hover-preview {
            opacity: 1;
            pointer-events: auto;
        }

        .slr-hover-preview {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 0.5rem;
            width: 12rem;
            height: 12rem;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
        }


        .slr-main-right {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            color: #757575;
        }

        .slr-main-right-title {
            font-size: 2rem;
            color: #000000;
            font-weight: bold;
            margin: 1rem 0;
        }

        .slr-main-right-description {
            font-size: 0.8rem;
        }

        .slr-main-right-description p {
            margin: 0.4rem 0;
        }

        .slr-main-right-dimensions {
            font-size: 0.8rem;
        }

        .slr-option-group {
            margin-bottom: 1.5rem;
        }

        .slr-option-label {
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.75rem;
            display: block;
        }

        .slr-option-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .slr-option-radio {
            display: none;
        }

        .slr-option-btn {
            background: #fff;
            color: #000;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            transition: all 0.15s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            min-width: fit-content;
        }

        .slr-option-btn:hover {
            border-color: #222222;
        }

        .slr-option-radio:checked + .slr-option-btn {
            background: #222222;
            color: #fff;
            border-color: #222222;
        }


        .slr-main-right-price {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .slr-main-right-price h2 {
            font-size: 1.5rem;
            color: #000000;
        }

        .slr-main-right-price p {
            font-size: 0.8rem;
        }

        .slr-quantity-group {
            margin-bottom: 1.5rem;
        }

        .slr-quantity-container {
            display: flex;
            align-items: center;
            width: 8rem;
            height: 2.5rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
        }

        .slr-quantity-btn {
            width: 2.5rem;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 1.25rem;
        }

        .slr-quantity-btn:first-child {
            border-right: 2px solid #e5e7eb;
        }

        .slr-quantity-btn:last-child {
            border-left: 2px solid #e5e7eb;
        }

        .slr-quantity-input {
            width: 3rem;
            height: 100%;
            text-align: center;
            border: none;
            outline: none;
            font-size: 1rem;
        }


        .slr-main-right-buttons {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .slr-main-right-buttons button {
            padding: 0.8rem 0.6rem;
            border-radius: 0.4rem;
            border: none;
            cursor: pointer;
            font-size: 1rem;
        }

        .slr-main-right-buttons .slr-main-right-card {
            background-color: #000000;
            color: white;
        }

        .slr-main-right-buttons .slr-main-right-buy {
            color: #000000;
        }

        .slr-main-right-share {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
        }

        .slr-main-right-share a {
            color: #757575;
            text-indent: unset;
        }

        .slr-description {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            padding: 5rem 1.5rem;
        }

        .slr-description .slr-description-title {
            font-size: 3.5rem;
            font-weight: bold;
        }

        .slr-description p {
            color: #757575;
        }

        .slr-info {
            width: 100%;
            height: 550px;
            position: relative;
        }

        .slr-info-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .slr-info-mask {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            background-color: rgb(0, 0, 0, .3);
        }

        .slr-mask-box {
            width: 400px;
            position: absolute;
            top: 4rem;
            left: 4rem;
            color: white;
        }

        .slr-mask-box h2 {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        @media screen and (width < 64rem) {
            .slr-main {
                display: flex;
                flex-direction: column;
            }

            .slr-main-left {
                flex-direction: column;
            }

            .slr-main-left .slr-main-left-preview-imgs {
                flex-direction: row;
            }

            .slr-thumbnail-btn {
                width: 8rem;
            }

            .slr-info .slr-mask-box {
                width: 80%;
                margin: auto;
                top: 5rem;
                left: 1rem;
            }

            .slr-info .slr-mask-box h2 {
                font-size: 2.5rem;
            }
        }


    </style>
</head>
<body>
<div class="slr-main">
    <div class="slr-main-left">
        <div class="slr-main-left-product-img">
            {% if product.featured_image %}
                <img src="{{ product.featured_image | img_url: '800x800' }}"
                     class="slr-main-image" id="slr-main-image"
                     alt="{{ product.featured_image.alt | escape }}">
            {% else %}
                <img src="https://via.placeholder.com/800x800?text=No+Image"
                     class="slr-main-image" id="slr-main-image" alt="No image available">
            {% endif %}
        </div>
        <div class="slr-main-left-preview-imgs" id="preview-imgs">
            {% if product.images.size > 1 %}
                {% for image in product.images %}
                    <div class="slr-thumbnail-container">
                        <button
                                class="slr-thumbnail-btn {% if forloop.first %}locked{% endif %}"
                                data-image="{{ image | img_url: '800x800' }}" data-alt="{{ image.alt | escape }}">
                            <img src="{{ image | img_url: '200x200' }}" class="slr-thumbnail-img"
                                 alt="{{ image.alt | escape }}">
                        </button>
                        <div class="slr-hover-preview">
                            <img src="{{ image | img_url: '400x400' }}" class="slr-thumbnail-img"
                                 alt="{{ image.alt | escape }}">
                        </div>
                    </div>
                {% endfor %}
            {% endif %}
        </div>
    </div>
    <div class="slr-main-right">
        <div class="slr-main-right-title">
            {{ product.title }}
        </div>
        <div class="slr-main-right-description">
            <p> {{ product.handle }}</p>
            {{ product.description }}
        </div>
        <div class="slr-main-right-dimensions">
            <p>Dimensions:</p>
            <div>
                Small: W190 x D60 x H285 mm / 5 kg
            </div>
        </div>

        {% for option in product.options_with_values %}
            <div class="slr-option-group">
                <label class="slr-option-label">{{ option.name }}</label>
                <div class="slr-option-buttons">
                    <div class="slr-option-buttons">
                        {% for value in option.values %}
                            <div>
                                <input type="radio" name="options[{{ option.name }}]"
                                       id="slr-{{ option.name | handleize }}-{{ value | handleize }}"
                                       value="{{ value }}"
                                       class="slr-option-radio" {% if forloop.first %}checked{% endif %}>
                                <label for="slr-{{ option.name | handleize }}-{{ value | handleize }}"
                                       class="slr-option-btn">
                                    <span>{{ value }}</span>
                                </label>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        {% endfor %}

        <div class="slr-main-right-price" id="slr-price-container">
            {% assign current_variant = product.selected_or_first_available_variant %}
            {% if current_variant.compare_at_price > current_variant.price %}
                <span class="slr-current-price" id="slr-current-price">{{ current_variant.price | money }}</span>
                <span class="slr-compare-price"
                      id="slr-compare-price">{{ current_variant.compare_at_price | money }}</span>
            {% else %}
                <span class="slr-current-price" id="slr-current-price">{{ current_variant.price | money }}</span>
            {% endif %}
            <p>Tax included.</p>
        </div>

        <div class="slr-quantity-group">
            <label class="slr-option-label">Quantity</label>
            <div class="slr-quantity-container">
                <button type="button" class="slr-quantity-btn" id="slr-decrease-btn">
                    <i class="ri-subtract-line">-</i>
                </button>
                <input type="text" name="quantity" class="slr-quantity-input"
                       value="1" min="1" id="slr-quantity">
                <button type="button" class="slr-quantity-btn" id="slr-increase-btn">
                    <i class="ri-add-line">+</i>
                </button>
            </div>
        </div>
        <div class="slr-main-right-buttons">
            <button class="slr-main-right-card" id="slr-add-to-cart-btn" type="button">Add to Card</button>
            <button class="slr-main-right-buy" id="slr-buy-now-btn" type="button">Buy it Now</button>
        </div>

        <div class="slr-main-right-share"
             style="--offset-top-desktop: 8px;--offset-bottom-desktop: 8px;--offset-top-mobile: 8px;--offset-bottom-mobile: 8px;">
            <span class="product-share-buttons__label">Share:</span>

            <a aria-label="Share" class="button-social js-social-share"
               data-input-fallback="share-input-template--18701885997208__product-template"
               data-share-title="PERSPECTYVA decor"
               data-share-url="https://demo-llab-design.myshopify.com/products/perspectyva-decor-copy" href="#">
                <svg aria-hidden="true" class="icon icon-social" fill="none" focusable="false" height="24"
                     viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M18 22C19.6569 22 21 20.6569 21 19C21 17.3431 19.6569 16 18 16C16.3431 16 15 17.3431 15 19C15 20.6569 16.3431 22 18 22Z"
                          stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                          stroke-width="1.5"></path>
                    <path d="M6 15C7.65685 15 9 13.6569 9 12C9 10.3431 7.65685 9 6 9C4.34315 9 3 10.3431 3 12C3 13.6569 4.34315 15 6 15Z"
                          stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                          stroke-width="1.5"></path>
                    <path d="M8.58984 13.5098L15.4198 17.4898" stroke="currentColor" stroke-linecap="round"
                          stroke-linejoin="round" stroke-width="1.5"></path>
                    <path d="M18 8C19.6569 8 21 6.65685 21 5C21 3.34315 19.6569 2 18 2C16.3431 2 15 3.34315 15 5C15 6.65685 16.3431 8 18 8Z"
                          stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                          stroke-width="1.5"></path>
                    <path d="M15.4098 6.50977L8.58984 10.4898" stroke="currentColor" stroke-linecap="round"
                          stroke-linejoin="round" stroke-width="1.5"></path>
                </svg>
            </a>
            <a aria-label="Share on Facebook" class="button-social"
               href="https://www.facebook.com/sharer/sharer.php?u=demo-llab-design.myshopify.com/products/perspectyva-decor-copy&amp;amp;src=sdkpreparse"
               rel="nofollow"
               target="_blank">
                <svg aria-hidden="true" class="icon icon-social" fill="none" focusable="false" height="24"
                     viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.1194 5.32003H16.9994V2.14003C16.0891 2.04538 15.1745 1.99865 14.2594 2.00003C11.5394 2.00003 9.67938 3.66003 9.67938 6.70003V9.32003H6.60938V12.88H9.67938V22H13.3594V12.88H16.4194L16.8794 9.32003H13.3594V7.05003C13.3594 6.00003 13.6394 5.32003 15.1194 5.32003Z"
                          fill="currentColor"></path>
                </svg>
            </a>
            <a aria-label="Share on X (Twitter)" class="button-social"
               href="https://twitter.com/intent/tweet?text=PERSPECTYVA decor&amp;url=demo-llab-design.myshopify.com/products/perspectyva-decor-copy"
               rel="nofollow"
               target="_blank">
                <svg aria-hidden="true" class="icon icon-social" fill="none" focusable="false" height="24"
                     viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1.05364 2L9.54759 13.0312L1 22H2.92372L10.4071 14.1477L16.4535 22H23L14.0281 10.3483L21.9842 2H20.0605L13.1686 9.23185L7.60013 2H1.05364ZM3.88261 3.37634H6.89009L20.1706 20.6235H17.1631L3.88261 3.37634Z"
                          fill="currentColor"></path>
                </svg>
            </a>
            <a aria-label="Share on Pinterest" class="button-social"
               href="http://pinterest.com/pin/create/button/?url=https://demo-llab-design.myshopify.com/products/perspectyva-decor-copy&amp;description=PERSPECTYVA decor"
               rel="nofollow"
               target="_blank">
                <svg aria-hidden="true" class="icon icon-social" fill="none" focusable="false" height="24"
                     viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 12.0003C1 16.5047 3.70857 20.3744 7.58442 22.0757C7.55348 21.3076 7.57892 20.3854 7.77589 19.5497C7.98738 18.6567 9.19127 13.5556 9.19127 13.5556C9.19127 13.5556 8.83988 12.8533 8.83988 11.8152C8.83988 10.185 9.78467 8.96754 10.9613 8.96754C11.9619 8.96754 12.4453 9.71908 12.4453 10.619C12.4453 11.6249 11.8038 13.1294 11.4738 14.5229C11.1982 15.6898 12.0589 16.6415 13.21 16.6415C15.2942 16.6415 16.6979 13.9646 16.6979 10.793C16.6979 8.38204 15.0741 6.5775 12.1207 6.5775C8.78393 6.5775 6.7052 9.06594 6.7052 11.8455C6.7052 12.8039 6.98776 13.4798 7.43033 14.0031C7.63383 14.2435 7.66211 14.3402 7.58846 14.6162C7.53569 14.8186 7.41452 15.3059 7.36433 15.499C7.29112 15.7776 7.06536 15.8772 6.81356 15.7743C5.27666 15.1469 4.56089 13.4638 4.56089 11.5717C4.56089 8.44693 7.19624 4.7 12.4226 4.7C16.6223 4.7 19.3865 7.73914 19.3865 11.0015C19.3865 15.3167 16.9875 18.5405 13.4512 18.5405C12.2636 18.5405 11.1465 17.8985 10.7638 17.1694C10.7638 17.1694 10.1252 19.7039 9.98997 20.1933C9.75674 21.0414 9.30024 21.8891 8.88284 22.5498C9.87215 22.8418 10.9172 23.0009 12.0004 23.0009C18.0748 23.0009 23 18.0758 23 12.0003C23 5.92506 18.0748 1 12.0004 1C5.9254 1 1 5.92506 1 12.0003Z"
                          fill="currentColor"></path>
                </svg>
            </a>
        </div>

    </div>
</div>


<div class="slr-description">
    <div class="slr-description-title">
        llab.design
    </div>
    <p>The DUALITY collection gives rise to new emotions through the dramatic contrast between the raw energy of the<br>material
        and the idea of delicate shapes with intricately carved details united and reproduced in natural stone.</p>
    <p>The pyramid-shaped details are interconnected by effortless lines, aesthetically contrasting strength and
        fragility.</p>
    <p>In consequence of the specially selected texture of natural marble, each item of the Duality collection will
        become<br>an accent element of any interior, complementing the space with elegance and functionality.</p>
</div>

<div class="slr-info">
    <img alt="info-img"
         class="slr-info-img"
         src="https://demo-llab-design.myshopify.com/cdn/shop/files/437962168_17959641926753198_2994085997509457625_n.jpg?v=1718784264&width=1920">
    <div class="slr-info-mask">
        <div class="slr-mask-box">
            <h2>Elevate Your Space with Custom Marble Furniture</h2>
            <p>Discover bespoke marble pieces that blend timeless elegance with modern design.</p>
        </div>
    </div>
</div>

<script>
    window.variants = {{ product.variants | json }};
    window.productOptions = {{ product.options_with_values | json }};
    // 获取店铺货币信息
    window.shopCurrency = {{ shop.currency | json }};
    window.shopMoneyFormat = {{ shop.money_format | json }};
</script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const quantityInput = document.getElementById('slr-quantity');
        const decreaseBtn = document.getElementById('slr-decrease-btn');
        const increaseBtn = document.getElementById('slr-increase-btn');
        const mainImage = document.getElementById('slr-main-image');
        const thumbnailBtns = document.querySelectorAll('.slr-thumbnail-btn');
        const optionInputs = document.querySelectorAll('input[name^="options["]');
        const variants = window.variants;
        const productOptions = window.productOptions || [];
        const shopCurrency = window.shopCurrency || 'USD';

        // 从产品数据结构中获取选项名称
        const optionNames = productOptions.map(option => option.name);

        // 根据货币代码获取合适的地区设置
        function getLocaleForCurrency(currencyCode) {
            const currencyLocaleMap = {
                'CNY': 'zh-CN',
                'USD': 'en-US',
                'EUR': 'de-DE',
                'GBP': 'en-GB',
                'JPY': 'ja-JP',
                'KRW': 'ko-KR',
                'HKD': 'zh-HK',
                'TWD': 'zh-TW',
                'SGD': 'en-SG',
                'AUD': 'en-AU',
                'CAD': 'en-CA'
            };
            return currencyLocaleMap[currencyCode] || 'en-US';
        }

        // 创建货币格式化器
        const currencyFormatter = new Intl.NumberFormat(getLocaleForCurrency(shopCurrency), {
            style: 'currency',
            currency: shopCurrency,
            minimumFractionDigits: 2,
            maximumFractionDigits: 2
        });

        // 格式化价格的辅助函数
        function formatPrice(priceInCents) {
            const priceInUnits = priceInCents / 100;
            return currencyFormatter.format(priceInUnits);
        }

        let currentImageIndex = 0;
        const images = Array.from(thumbnailBtns).map(btn => ({
            src: btn.dataset.image,
            alt: btn.dataset.alt
        }));

        // 缩略图hover事件
        thumbnailBtns.forEach((btn, index) => {
            // 添加hover事件
            btn.addEventListener('mouseenter', function () {
                currentImageIndex = index;
                mainImage.src = images[index].src;
                mainImage.alt = images[index].alt;
                updateThumbnailSelection();
            });

            btn.addEventListener('mouseleave', function () {
                // 鼠标离开时保持当前选中的图片状态
                // 不需要做任何改变，保持当前状态
            });
        });

        function updateThumbnailSelection() {
            thumbnailBtns.forEach((btn, index) => {
                if (index === currentImageIndex) {
                    btn.classList.add('locked');
                } else {
                    btn.classList.remove('locked');
                }
            });
        }

        // 数量控制
        decreaseBtn.addEventListener('click', function () {
            let value = parseInt(quantityInput.value);
            if (value > 1) {
                quantityInput.value = value - 1;
            }
        });

        increaseBtn.addEventListener('click', function () {
            let value = parseInt(quantityInput.value);
            quantityInput.value = value + 1;
        });

        quantityInput.addEventListener('change', function () {
            if (this.value < 1) this.value = 1;
        });


        // 监听选项变化，切换变体图片和价格
        optionInputs.forEach(input => {
            input.addEventListener('change', function () {
                updateVariantImage();
            });
        });

        function updateVariantImage() {
            // 获取当前所有选中的值
            const selectedOptions = {};
            optionInputs.forEach(input => {
                if (input.checked) {
                    const name = input.name.match(/options\[(.+)\]/)[1];
                    selectedOptions[name] = input.value;
                }
            });

            // 找到匹配的变体
            const matchedVariant = variants.find(variant => {
                return variant.options.every((opt, idx) => {
                    const optionName = optionNames[idx];
                    console.log(optionName, opt, selectedOptions[optionName]);
                    return selectedOptions[optionName] === opt;
                });
            });

            // 更新价格和图片
            if (matchedVariant) {
                updatePrice(matchedVariant);

                if (matchedVariant.featured_image && matchedVariant.featured_image.src) {
                    const baseUrl = matchedVariant.featured_image.src;
                    const separator = baseUrl.includes('?') ? '&' : '?';
                    mainImage.src = baseUrl + separator + 'width=800&height=800';
                    mainImage.alt = matchedVariant.featured_image.alt || '';
                    const variantImageSrc = matchedVariant.featured_image.src;
                    let foundThumbnail = false;

                    thumbnailBtns.forEach((btn, index) => {
                        const btnImageSrc = btn.dataset.image;
                        if (btnImageSrc && btnImageSrc.includes(variantImageSrc.split('?')[0])) {
                            currentImageIndex = index;
                            foundThumbnail = true;
                        }
                    });
                }
            }
        }

        // 更新价格显示
        function updatePrice(variant) {
            const currentPriceEl = document.getElementById('slr-current-price');
            const comparePriceEl = document.getElementById('slr-compare-price');
            const priceContainer = document.getElementById('slr-price-container');

            if (currentPriceEl) {
                // 使用原生货币格式化
                currentPriceEl.textContent = formatPrice(variant.price);
            }

            // 处理对比价格
            if (variant.compare_at_price && variant.compare_at_price > variant.price) {
                if (comparePriceEl) {
                    comparePriceEl.textContent = formatPrice(variant.compare_at_price);
                    comparePriceEl.style.display = 'block';
                }
            } else {
                if (comparePriceEl) {
                    comparePriceEl.style.display = 'none';
                }
            }
        }


        // 获取当前选中的变体ID
        function getCurrentVariantId() {
            const selectedOptions = {};
            optionInputs.forEach(input => {
                if (input.checked) {
                    const name = input.name.match(/options\[(.+)\]/)[1];
                    selectedOptions[name] = input.value;
                }
            });

            const matchedVariant = variants.find(variant => {
                return variant.options.every((opt, idx) => {
                    const optionName = optionNames[idx];
                    return selectedOptions[optionName] === opt;
                });
            });

            return matchedVariant ? matchedVariant.id : {{ product.selected_or_first_available_variant.id }};
        }

        // 获取当前数量
        function getCurrentQuantity() {
            return parseInt(quantityInput.value) || 1;
        }

        // 立即购买功能
        document.getElementById('slr-buy-now-btn').addEventListener('click', function () {
            const variantId = getCurrentVariantId();
            const quantity = getCurrentQuantity();

            fetch('/cart/add.js', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({id: variantId, quantity: quantity})
            })
                .then(function () {
                    window.location.href = '/checkout';
                })
                .catch(function (error) {
                    console.error('立即购买失败:', error);
                });
        });

        // 加入购物车功能
        document.getElementById('slr-add-to-cart-btn').addEventListener('click', function () {
            const variantId = getCurrentVariantId();
            const quantity = getCurrentQuantity();
            const button = this;
            const originalText = button.textContent;

            fetch('/cart/add.js', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({id: variantId, quantity: quantity})
            })
                .then(function (response) {
                    if (response.ok) {
                        return response.json();
                    } else {
                        throw new Error('添加失败');
                    }
                })
                .then(function (data) {
                    button.textContent = '{{ settings.added_to_cart_text | default: "✔️Added" }}';
                    setTimeout(function () {
                        button.textContent = originalText;
                    }, 3000);
                })
                .catch(function (error) {
                    console.error('加入购物车失败:', error);
                });
        });
    });
</script>

</body>
</html>